<a href="/">Home</a> | <a href="/checkpoint/add">Add a Stage</a>

<br><br>
<table>
<tr><td>Runway:</td>
	<td><% if(checkpoint.runway){%><%= checkpoint.runway.name %><%}else{%>No Runway<%}%></td></tr>

<tr><td>Stage:</td>
	<td><%= checkpoint.stage.name %></td></tr>
<tr><td>Name:</td><td><input type="text" id="checkpoint" value="<%= checkpoint.name %>"></td></tr>
<tr><td colspan="2"></td></tr>
<tr><td>Content Type</td>
	<td><select id="content_type">
		<option value="">Select Content Type</option>
		<option value="text" <% if(checkpoint.contentType == "text"){ %>selected<%}%>>Text</option>
		<option value="url" <% if(checkpoint.contentType == "url"){ %>selected<%}%>>Url</option>
		<option vaue="file" <% if(checkpoint.contentType == "file"){ %>selected<%}%>>File</option>
		</select></td></tr>
		

<tr><td>General Content:</td><td id="content"><input type="text" id="content_text" value="<%= checkpoint.content %>"></td></tr>
<tr><td colspan="2"><input type="button" value="Edit" id="btnEditCheckpoint" /> &nbsp; 
<input type="button" value="Delete" id="btnDeleteCheckpoint" /></td></tr>
</table>
<input type="hidden" id="id" value="<%= checkpoint.id %>" />


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
$("#btnEditCheckpoint").on("click", function(){
	
	var id = $("#id").val(),
		contentType = $("#content_type").val(),
		content = $("#content_text").val(),
		name = $("#checkpoint").val();

	$.ajax({
		
		type: "GET",
		data: "id="+id+"&content_type="+contentType+"&content="+content+"&name="+name,
		url: "/checkpoint/save_edit",
		success: function(err, resp){
			alert("Saved Checkpoint!");
		},
		error: function(err, resp){
			
			alert("Err");
		}
		
	});
	
});


$("#content_type").on("change", function(){
	
	var option = $("#content_type").val();
	
	if(option === "File"){
	
		//Hide the text 
		$("#content_text").hide();	
		//Show the title.
		$("#content").append("<input type='file' id='content_file' /> <span id='note'>Note:  Will not allow uploading since server is out in the public.</span>");
	
	}	
	else{
	
		//Toggle file.
		if($("#content_file").length > 0){

			$("#content_file").hide();
			$("#note").hide();
			$("#content_text").show();
		}
	}


});


$("#btnDeleteCheckpoint").on("click", function(){
	
	var id = $("#id").val();

	$.ajax({
		
		type: "GET",
		data: "id="+id,
		url: "/checkpoint/delete",
		success: function(err, resp){
			alert("Deleted Checkpoint!");
		},
		error: function(err, resp){
			
			alert("Err");
		}
		
	});
	
});
</script>